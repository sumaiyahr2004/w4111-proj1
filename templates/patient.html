<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Patients</title>
  <style>
    body { font-family: system-ui, sans-serif; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #000; padding: 8px; text-align: left; }
    th { background: #f2f2f2; }
    .actions a, .actions button { margin-right: 8px; }
    .toolbar { display:flex; align-items:center; gap:12px; margin: 12px 0; }
    .toolbar form { display:inline-flex; gap:8px; }
  </style>
</head>
<body>
  <h1>Patient List</h1>

  <div class="toolbar">
    <a href="{{ url_for('patient_new') }}">+ New Patient</a>
    <!-- optional name filter: implement in server to read request.args.get('q') -->
    <form method="get" action="{{ url_for('patient') }}">
      <input name="q" placeholder="Search nameâ€¦" value="{{ request.args.get('q','') }}">
      <button type="submit">Search</button>
    </form>
    <a href="{{ url_for('index') }}">Home</a>
  </div>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Full Name</th>
        <th>Birthdate</th>
        <th>Sex</th>
        <th>Contact Phone</th>
        <th>Contact Email</th>
        <th>Emergency Contact</th>
        <th>Emergency Phone</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
    {% for p in patient %}
      <tr>
        <td>{{ p.patient_id }}</td>
        <td>{{ p.full_name }}</td>
        <td>{{ p.birthdate }}</td>
        <td>{{ p.sex }}</td>
        <td>{{ p.contact_phone }}</td>
        <td>{{ p.contact_email }}</td>
        <td>{{ p.emergency_contact_name }}</td>
        <td>{{ p.emergency_contact_phone }}</td>
        <td class="actions">
          <a href="{{ url_for('patient_edit', patient_id=p.patient_id) }}">Edit</a>
          <form method="post"
                action="{{ url_for('patient_delete', patient_id=p.patient_id) }}"
                style="display:inline"
                onsubmit="return confirm('Delete patient #{{ p.patient_id }}?');">
            <button type="submit">Delete</button>
          </form>
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  {% if not patient or patient|length == 0 %}
    <p><em>No patients found.</em></p>
  {% endif %}
</body>
</html>
